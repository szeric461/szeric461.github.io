<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreetWorks Garage - Aut√≥ Tuning Tycoon</title>
    
    <!-- Tailwind CSS a st√≠lusokhoz -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Import Map a React √©s Lucide ikonok bet√∂lt√©s√©hez -->
    <script type="importmap">
      {
        "imports": {
          "react": "https://esm.sh/react@18.2.0",
          "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
          "lucide-react": "https://esm.sh/lucide-react@0.263.1"
        }
      }
    </script>
    
    <!-- Babel a JSX ford√≠t√°shoz -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-slate-950 text-slate-200 select-none">
    <div id="root"></div>

    <!-- A j√°t√©k k√≥dja -->
    <script type="text/babel" data-type="module">
        import React, { useState, useEffect } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
          Wrench, Car, DollarSign, Trophy, Users, Zap, 
          Settings, ShoppingBag, ArrowRight, Gauge, 
          TrendingUp, CheckCircle, XCircle, Play, StopCircle 
        } from 'lucide-react';

        // --- ADATSTRUKT√öR√ÅK √âS KONSTANSOK ---

        const CAR_TYPES = [
          { id: 'hatch', name: 'Civic Duty', baseHp: 110, baseHandling: 50, type: 'Utcai', rarity: 1 },
          { id: 'sedan', name: 'Bimmer E36', baseHp: 190, baseHandling: 65, type: 'Drift', rarity: 2 },
          { id: 'muscle', name: 'Mustang GT', baseHp: 300, baseHandling: 30, type: 'Drag', rarity: 2 },
          { id: 'jdm', name: 'Skyline R34', baseHp: 280, baseHandling: 80, type: 'Legend√°s', rarity: 3 },
          { id: 'super', name: 'Lambo V12', baseHp: 500, baseHandling: 90, type: 'VIP', rarity: 4 },
        ];

        const PARTS_SHOP = [
          { id: 'ecu1', name: 'ECU Remap Stage 1', type: 'performance', cost: 500, hp: 20, handling: 0 },
          { id: 'turbo1', name: 'Sport Turb√≥', type: 'performance', cost: 1200, hp: 50, handling: -5 },
          { id: 'tires1', name: 'Semi-Slick Gumik', type: 'handling', cost: 800, hp: 0, handling: 25 },
          { id: 'suspension1', name: 'Sport Fut√≥m≈±', type: 'handling', cost: 1000, hp: 0, handling: 20 },
          { id: 'nitro', name: 'Nitro Rendszer', type: 'performance', cost: 2000, hp: 80, handling: -10 },
          { id: 'bodykit', name: 'Sz√©les√≠tett Bodykit', type: 'visual', cost: 1500, hp: 0, handling: 5, appeal: 20 },
          { id: 'paint_neon', name: 'Neon Z√∂ld F√©nyez√©s', type: 'visual', cost: 300, hp: 0, handling: 0, appeal: 10 },
          { id: 'paint_midnight', name: '√âjfekete Matt', type: 'visual', cost: 500, hp: 0, handling: 0, appeal: 15 },
        ];

        const UPGRADES = [
          { id: 'lift', name: 'Hidraulikus Emel≈ë', cost: 2000, desc: 'Munkasebess√©g +20%', effect: { type: 'speed', value: 0.2 } },
          { id: 'tools', name: 'Profi Szersz√°mk√©szlet', cost: 1500, desc: 'T√∂bb XP a munk√°k√©rt', effect: { type: 'xp', value: 1.5 } },
          { id: 'decor', name: '√úgyf√©lv√°r√≥', cost: 3000, desc: 'Jobb √ºgyfelek (Magasabb jutalom)', effect: { type: 'reward', value: 1.2 } },
        ];

        const EMPLOYEES = [
          { id: 1, name: 'G√©za', role: 'Tanul√≥', skill: 0.8, cost: 500, wage: 50 },
          { id: 2, name: 'Sanyi', role: 'Motor Specialista', skill: 1.5, cost: 2000, wage: 200 },
          { id: 3, name: 'Niki', role: 'Drift M√©rn√∂k', skill: 1.3, cost: 1500, wage: 150 },
        ];

        // --- SEG√âDF√úGGV√âNYEK ---

        const generateJob = (level) => {
          const rarityRoll = Math.random() + (level * 0.05);
          let possibleCars = CAR_TYPES.filter(c => c.rarity <= (rarityRoll > 0.8 ? 4 : rarityRoll > 0.5 ? 2 : 1));
          const carBase = possibleCars[Math.floor(Math.random() * possibleCars.length)];
          
          return {
            id: Date.now() + Math.random(), 
            car: { ...carBase, currentHp: carBase.baseHp, currentHandling: carBase.baseHandling, color: 'gray', parts: [] },
            requirements: {
              minHp: Math.floor(carBase.baseHp * (1 + Math.random() * 0.5)),
              minHandling: carBase.baseHandling,
              visual: Math.random() > 0.7 
            },
            reward: Math.floor(1000 + (level * 200) + (Math.random() * 500)),
            deadline: 100, // Id≈ëegys√©g
            status: 'pending' // pending, active, completed
          };
        };

        // --- F≈ê KOMPONENS ---

        function StreetWorksGarage() {
          // √Ållapotv√°ltoz√≥k
          const [money, setMoney] = useState(2000);
          const [reputation, setReputation] = useState(0);
          const [level, setLevel] = useState(1);
          const [day, setDay] = useState(1);
          const [inventory, setInventory] = useState([]);
          const [activeJob, setActiveJob] = useState(null);
          const [jobQueue, setJobQueue] = useState([generateJob(1), generateJob(1)]);
          const [myCars, setMyCars] = useState([]); // Versenyaut√≥k
          const [garageUpgrades, setGarageUpgrades] = useState([]);
          const [staff, setStaff] = useState([]);
          
          const [view, setView] = useState('garage'); // garage, shop, office, race
          const [notification, setNotification] = useState(null);
          const [workProgress, setWorkProgress] = useState(0);
          const [isWorking, setIsWorking] = useState(false);

          // √ârtes√≠t√©s kezel≈ë
          const showNotification = (msg, type = 'info') => {
            setNotification({ msg, type });
            setTimeout(() => setNotification(null), 3000);
          };

          // Munka logika
          useEffect(() => {
            let interval;
            if (isWorking && activeJob) {
              interval = setInterval(() => {
                setWorkProgress(prev => {
                  // Sebess√©g kalkul√°ci√≥: Alap + Staff + Upgrades
                  let speed = 1;
                  if (garageUpgrades.includes('lift')) speed += 0.5;
                  staff.forEach(s => speed += (s.skill - 0.5)); // B√≥nusz a stafft√≥l
                  
                  const next = prev + speed;
                  if (next >= 100) {
                    clearInterval(interval);
                    setIsWorking(false);
                    finishJob();
                    return 100;
                  }
                  return next;
                });
              }, 50);
            }
            return () => clearInterval(interval);
          }, [isWorking, activeJob, staff, garageUpgrades]);

          const startWork = () => {
            if (!activeJob) return;
            setWorkProgress(0);
            setIsWorking(true);
          };

          const finishJob = () => {
            // Ellen≈ërizz√ºk, hogy megfelel-e a k√∂vetelm√©nyeknek
            const car = activeJob.car;
            const req = activeJob.requirements;
            const success = car.currentHp >= req.minHp; // Egyszer≈±s√≠tett felt√©tel

            if (success) {
              let finalReward = activeJob.reward;
              if (garageUpgrades.includes('decor')) finalReward *= 1.2;
              
              setMoney(prev => prev + Math.floor(finalReward));
              setReputation(prev => prev + 50);
              showNotification(`Munka k√©sz! +$${Math.floor(finalReward)}`, 'success');
              
              // Level up check
              if (reputation + 50 > level * 1000) {
                setLevel(prev => prev + 1);
                showNotification("SZINTL√âP√âS! √öj alkatr√©szek el√©rhet≈ëk!", 'success');
              }
            } else {
              setMoney(prev => prev + Math.floor(activeJob.reward * 0.5));
              showNotification("Az √ºgyf√©l nem el√©gedett. Csak r√©szleges fizet√©s.", 'error');
            }
            
            setActiveJob(null);
            setWorkProgress(0);
          };

          const buyPart = (part) => {
            if (money >= part.cost) {
              setMoney(prev => prev - part.cost);
              setInventory(prev => [...prev, part]);
              showNotification(`${part.name} megv√°s√°rolva!`, 'success');
            } else {
              showNotification("Nincs el√©g p√©nzed!", 'error');
            }
          };

          const installPart = (part, indexInInventory) => {
            if (!activeJob) return;
            
            // Alkatr√©sz felszerel√©se
            const updatedCar = { ...activeJob.car };
            updatedCar.parts.push(part);
            updatedCar.currentHp += (part.hp || 0);
            updatedCar.currentHandling += (part.handling || 0);
            if (part.type === 'visual') {
               // Visual v√°ltoztat√°sok egyszer≈±s√≠t√©se
               if (part.name.includes('F√©nyez√©s')) updatedCar.color = part.name.includes('Z√∂ld') ? '#39ff14' : '#1a1a1a';
            }

            setActiveJob({ ...activeJob, car: updatedCar });
            
            // T√∂rl√©s az inventoryb√≥l
            const newInv = [...inventory];
            newInv.splice(indexInInventory, 1);
            setInventory(newInv);
            
            showNotification(`${part.name} felszerelve!`, 'success');
          };

          const acceptJob = (job) => {
            if (activeJob) {
              showNotification("El≈ëbb fejezd be a jelenlegi munk√°t!", 'error');
              return;
            }
            setActiveJob(job);
            setJobQueue(prev => prev.filter(j => j.id !== job.id));
            // √öj munka gener√°l√°sa a list√°ba, hogy mindig legyen v√°laszt√©k
            setTimeout(() => setJobQueue(prev => [...prev, generateJob(level)]), 5000);
          };

          const buyCar = (template) => {
            const cost = template.baseHp * 20;
            if (money >= cost) {
              setMoney(prev => prev - cost);
              setMyCars(prev => [...prev, { ...template, currentHp: template.baseHp, currentHandling: template.baseHandling, parts: [] }]);
              showNotification("√öj projektaut√≥ a gar√°zsban!", 'success');
            } else {
              showNotification("Nincs el√©g p√©nzed erre az aut√≥ra!", 'error');
            }
          };

          const hireStaff = (employee) => {
            if (money >= employee.cost) {
              setMoney(prev => prev - employee.cost);
              setStaff(prev => [...prev, employee]);
              showNotification(`${employee.name} felv√©ve!`, 'success');
            }
          };

          // --- ALKOMPONENSEK ---

          const Header = () => (
            <div className="bg-slate-900 border-b border-slate-700 p-4 flex justify-between items-center text-white sticky top-0 z-10 shadow-lg">
              <div className="flex items-center gap-2">
                <Wrench className="text-cyan-400" />
                <h1 className="text-xl font-bold italic tracking-wider">STREETWORKS <span className="text-cyan-400">GARAGE</span></h1>
              </div>
              <div className="flex gap-6 text-sm md:text-base">
                <div className="flex items-center gap-1 text-green-400 font-mono">
                  <DollarSign size={16} /> {money.toLocaleString()}
                </div>
                <div className="flex items-center gap-1 text-yellow-400 font-mono">
                  <Trophy size={16} /> REP: {reputation} (Lvl {level})
                </div>
                <div className="flex items-center gap-1 text-gray-400">
                  Nap: {day}
                </div>
              </div>
            </div>
          );

          const Navigation = () => (
            <div className="flex bg-slate-800 p-2 justify-center gap-4 border-b border-slate-700 overflow-x-auto">
              <button onClick={() => setView('garage')} className={`flex items-center gap-2 px-4 py-2 rounded ${view === 'garage' ? 'bg-cyan-600 text-white' : 'text-slate-400 hover:bg-slate-700'}`}>
                <Wrench size={18} /> M≈±hely
              </button>
              <button onClick={() => setView('shop')} className={`flex items-center gap-2 px-4 py-2 rounded ${view === 'shop' ? 'bg-cyan-600 text-white' : 'text-slate-400 hover:bg-slate-700'}`}>
                <ShoppingBag size={18} /> Alkatr√©szek
              </button>
              <button onClick={() => setView('office')} className={`flex items-center gap-2 px-4 py-2 rounded ${view === 'office' ? 'bg-cyan-600 text-white' : 'text-slate-400 hover:bg-slate-700'}`}>
                <Users size={18} /> Iroda
              </button>
              <button onClick={() => setView('race')} className={`flex items-center gap-2 px-4 py-2 rounded ${view === 'race' ? 'bg-purple-600 text-white' : 'text-slate-400 hover:bg-slate-700'}`}>
                <Gauge size={18} /> Verseny
              </button>
            </div>
          );

          // --- N√âZETEK ---

          const GarageView = () => (
            <div className="p-4 grid grid-cols-1 lg:grid-cols-3 gap-6">
              {/* Bal oldal: Akt√≠v Aut√≥ */}
              <div className="lg:col-span-2 bg-slate-800 rounded-xl p-6 border border-slate-700 relative overflow-hidden">
                <h2 className="text-xl text-white mb-4 flex items-center gap-2">
                  <Car className="text-cyan-400" /> Akt√≠v Projekt
                </h2>
                
                {activeJob ? (
                  <div className="flex flex-col gap-6">
                    <div className="h-48 bg-slate-900 rounded-lg flex items-center justify-center relative border-2 border-slate-600 group">
                      {/* Aut√≥ vizualiz√°ci√≥ */}
                      <div className="relative w-64 h-24 transition-all duration-500">
                        <div 
                          className="absolute inset-0 rounded-lg shadow-[0_20px_50px_rgba(0,0,0,0.5)]"
                          style={{ backgroundColor: activeJob.car.color }}
                        ></div>
                        {/* Kerekek */}
                        <div className="absolute -bottom-4 left-4 w-10 h-10 bg-black rounded-full border-2 border-gray-500 animate-pulse"></div>
                        <div className="absolute -bottom-4 right-4 w-10 h-10 bg-black rounded-full border-2 border-gray-500 animate-pulse"></div>
                        <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-slate-900 font-bold text-xl uppercase opacity-50 mix-blend-overlay">
                          {activeJob.car.name}
                        </div>
                      </div>
                      
                      {/* Info Overlay */}
                      <div className="absolute top-2 right-2 bg-black/60 p-2 rounded text-xs text-white">
                        <div className="flex justify-between w-32"><span>Er≈ë:</span> <span className="text-green-400">{activeJob.car.currentHp} HP</span></div>
                        <div className="flex justify-between w-32"><span>Kezelhet≈ës√©g:</span> <span className="text-blue-400">{activeJob.car.currentHandling}</span></div>
                      </div>
                    </div>

                    {/* C√©lok */}
                    <div className="bg-slate-900/50 p-4 rounded border border-slate-700">
                      <h3 className="text-gray-400 text-sm uppercase mb-2">Megrendel√©s C√©ljai:</h3>
                      <div className="flex flex-wrap gap-4 text-sm">
                        <div className={`flex items-center gap-1 ${activeJob.car.currentHp >= activeJob.requirements.minHp ? 'text-green-500' : 'text-red-500'}`}>
                          {activeJob.car.currentHp >= activeJob.requirements.minHp ? <CheckCircle size={16}/> : <XCircle size={16}/>}
                          Min. {activeJob.requirements.minHp} HP
                        </div>
                      </div>
                    </div>

                    {/* Akci√≥k */}
                    <div className="space-y-4">
                      <div className="bg-slate-900 p-4 rounded border border-slate-700 min-h-[100px]">
                        <h3 className="text-cyan-400 text-sm mb-2 flex items-center gap-2"><Wrench size={14}/> Rakt√°rk√©szlet (Kattints a be√©p√≠t√©shez)</h3>
                        {inventory.length === 0 ? (
                          <p className="text-gray-500 text-sm italic">√úres a rakt√°r. V√°s√°rolj alkatr√©szt a boltban!</p>
                        ) : (
                          <div className="flex flex-wrap gap-2">
                            {inventory.map((part, idx) => (
                              <button 
                                key={idx}
                                onClick={() => installPart(part, idx)}
                                disabled={isWorking}
                                className="bg-slate-700 hover:bg-slate-600 px-3 py-1 rounded text-xs text-white border border-slate-500 transition-colors disabled:opacity-50"
                              >
                                {part.name}
                              </button>
                            ))}
                          </div>
                        )}
                      </div>

                      {isWorking ? (
                        <div className="w-full bg-slate-700 rounded-full h-8 overflow-hidden relative">
                          <div 
                            className="bg-cyan-500 h-full transition-all duration-100 ease-linear flex items-center justify-center text-xs font-bold text-slate-900" 
                            style={{ width: `${workProgress}%` }}
                          >
                            MUNKAV√âGZ√âS... {Math.floor(workProgress)}%
                          </div>
                        </div>
                      ) : (
                        <button 
                          onClick={startWork}
                          className="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-3 rounded shadow-lg shadow-green-900/50 transition-all flex items-center justify-center gap-2"
                        >
                          <Play size={20} /> MUNKA BEFEJEZ√âSE (Lead√°s)
                        </button>
                      )}
                    </div>

                  </div>
                ) : (
                  <div className="h-64 flex flex-col items-center justify-center text-slate-500 border-2 border-dashed border-slate-700 rounded-lg">
                    <Car size={48} className="mb-2 opacity-50" />
                    <p>A m≈±hely√°ll√°s √ºres.</p>
                    <p className="text-sm">V√°lassz munk√°t a jobb oldali list√°b√≥l!</p>
                  </div>
                )}
              </div>

              {/* Jobb oldal: Munkalista */}
              <div className="bg-slate-800 rounded-xl p-4 border border-slate-700 h-fit">
                <h2 className="text-lg text-white mb-4 flex items-center gap-2 border-b border-slate-600 pb-2">
                  <TrendingUp className="text-yellow-400" /> El√©rhet≈ë Munk√°k
                </h2>
                <div className="space-y-3">
                  {jobQueue.map(job => (
                    <div key={job.id} className="bg-slate-900 p-3 rounded border border-slate-700 hover:border-cyan-500 transition-colors cursor-pointer relative group">
                      <div className="flex justify-between items-start mb-1">
                        <span className="font-bold text-cyan-300">{job.car.name}</span>
                        <span className="text-green-400 font-mono text-sm">${job.reward}</span>
                      </div>
                      <div className="text-xs text-gray-400 mb-2">
                        C√©l: {job.requirements.minHp} HP
                      </div>
                      <button 
                        onClick={() => acceptJob(job)}
                        className="w-full bg-slate-700 hover:bg-cyan-700 text-white text-xs py-1 rounded transition-colors"
                      >
                        Elv√°llal
                      </button>
                    </div>
                  ))}
                </div>
              </div>
            </div>
          );

          const ShopView = () => (
            <div className="p-4">
              <h2 className="text-2xl text-white mb-6 flex items-center gap-2">
                <ShoppingBag className="text-cyan-400" /> Tuning Shop
              </h2>
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                {PARTS_SHOP.map(part => (
                  <div key={part.id} className="bg-slate-800 p-4 rounded-lg border border-slate-700 hover:shadow-lg hover:shadow-cyan-900/20 transition-all">
                    <div className="flex justify-between items-start mb-2">
                      <h3 className="text-white font-bold">{part.name}</h3>
                      <span className={`text-xs px-2 py-0.5 rounded ${part.type === 'performance' ? 'bg-red-900 text-red-200' : part.type === 'visual' ? 'bg-purple-900 text-purple-200' : 'bg-blue-900 text-blue-200'}`}>
                        {part.type === 'performance' ? 'Teljes√≠tm√©ny' : part.type === 'visual' ? 'Optika' : 'Fut√≥m≈±'}
                      </span>
                    </div>
                    <div className="text-sm text-gray-400 mb-4 space-y-1">
                      {part.hp !== 0 && <div>HP: <span className={part.hp > 0 ? "text-green-400" : "text-red-400"}>{part.hp > 0 ? '+' : ''}{part.hp}</span></div>}
                      {part.handling !== 0 && <div>Kezelhet≈ës√©g: <span className="text-blue-400">+{part.handling}</span></div>}
                    </div>
                    <button 
                      onClick={() => buyPart(part)}
                      className="w-full bg-green-700 hover:bg-green-600 text-white py-2 rounded font-bold flex justify-center items-center gap-1"
                    >
                      <DollarSign size={14} /> {part.cost}
                    </button>
                  </div>
                ))}
              </div>
            </div>
          );

          const OfficeView = () => (
            <div className="p-4 grid grid-cols-1 md:grid-cols-2 gap-6">
              {/* Fejleszt√©sek */}
              <div className="bg-slate-800 p-6 rounded-lg border border-slate-700">
                <h2 className="text-xl text-white mb-4 flex items-center gap-2">
                  <Zap className="text-yellow-400" /> M≈±hely Fejleszt√©se
                </h2>
                <div className="space-y-4">
                  {UPGRADES.map(upgrade => {
                    const owned = garageUpgrades.includes(upgrade.id);
                    return (
                      <div key={upgrade.id} className={`p-4 rounded border flex justify-between items-center ${owned ? 'bg-slate-900 border-green-500' : 'bg-slate-700 border-slate-600'}`}>
                        <div>
                          <h3 className="text-white font-bold">{upgrade.name}</h3>
                          <p className="text-xs text-gray-300">{upgrade.desc}</p>
                        </div>
                        {owned ? (
                          <span className="text-green-400 font-bold text-sm">MEGV√âVE</span>
                        ) : (
                          <button 
                            onClick={() => {
                              if(money >= upgrade.cost) {
                                setMoney(m => m - upgrade.cost);
                                setGarageUpgrades(prev => [...prev, upgrade.id]);
                                showNotification("Fejleszt√©s megv√°s√°rolva!", 'success');
                              } else {
                                showNotification("Nincs el√©g p√©nzed!", 'error');
                              }
                            }}
                            className="bg-yellow-600 hover:bg-yellow-500 px-3 py-1 rounded text-white text-sm"
                          >
                            ${upgrade.cost}
                          </button>
                        )}
                      </div>
                    );
                  })}
                </div>
              </div>

              {/* Szem√©lyzet */}
              <div className="bg-slate-800 p-6 rounded-lg border border-slate-700">
                <h2 className="text-xl text-white mb-4 flex items-center gap-2">
                  <Users className="text-blue-400" /> Alkalmazottak
                </h2>
                <div className="space-y-4">
                  {EMPLOYEES.map(emp => {
                     const hired = staff.some(s => s.id === emp.id);
                     return (
                      <div key={emp.id} className="bg-slate-900 p-4 rounded border border-slate-700 flex justify-between items-center">
                        <div>
                          <h3 className="text-white font-bold">{emp.name}</h3>
                          <p className="text-xs text-cyan-400">{emp.role}</p>
                        </div>
                        {hired ? (
                           <span className="text-gray-500 text-sm">Felv√©ve</span>
                        ) : (
                          <button 
                            onClick={() => hireStaff(emp)}
                            className="bg-green-700 hover:bg-green-600 px-3 py-1 rounded text-white text-sm"
                          >
                            Felv√©tel (${emp.cost})
                          </button>
                        )}
                      </div>
                     );
                  })}
                  {staff.length === 0 && <p className="text-gray-500 text-sm italic">M√©g nincsenek alkalmazottaid.</p>}
                </div>
              </div>
            </div>
          );

          const RaceView = () => {
            const [raceLog, setRaceLog] = useState([]);
            const [racing, setRacing] = useState(false);

            const startRace = (playerCar) => {
              if (racing) return;
              setRacing(true);
              setRaceLog([]);
              
              const opponentHp = playerCar.currentHp * (0.8 + Math.random() * 0.4);
              const opponentName = "Street King " + Math.floor(Math.random() * 100);
              
              let logs = [];
              logs.push(`üèÅ VERSENY: ${playerCar.name} vs ${opponentName}`);
              logs.push(`‚ö†Ô∏è ${opponentName} aut√≥ja ${Math.floor(opponentHp)} l√≥er≈ës.`);

              setTimeout(() => {
                setRaceLog(l => [...l, "üî¥ üî¥ üî¥ RAJT!"]);
                
                setTimeout(() => {
                  // Verseny logika
                  const playerScore = (playerCar.currentHp * 1.2) + (playerCar.currentHandling * 0.8) + (Math.random() * 50);
                  const opponentScore = opponentHp * 1.2 + 50 + (Math.random() * 50);

                  if (playerScore > opponentScore) {
                    setRaceLog(l => [...l, `üí® ${playerCar.name} kil≈ë a rajtn√°l!`, `‚úÖ GY≈êZELEM! Nyerem√©ny: $1000`]);
                    setMoney(m => m + 1000);
                    setReputation(r => r + 100);
                  } else {
                    setRaceLog(l => [...l, `‚ùå ${opponentName} gyorsabb volt. Vesztett√©l!`, `üìâ A h√≠rneved csorb√°t szenvedett.`]);
                  }
                  setRacing(false);
                }, 1500);
              }, 1000);
            };

            return (
              <div className="p-4 grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div className="bg-slate-800 p-6 rounded-lg border border-slate-700">
                   <h2 className="text-xl text-white mb-4">Saj√°t Aut√≥k (Vegy√©l √∫jat a projektjeidb≈ël!)</h2>
                   <p className="text-gray-400 text-sm mb-4">Jelenleg csak a megrendel≈ëk aut√≥it szereled. (Hamarosan: Vegy√©l saj√°t roncsot √©s √©p√≠tsd fel versenyre!)</p>
                   
                   {/* Demo Race Car gomb a tesztel√©shez */}
                   <div className="bg-slate-900 p-4 rounded border border-purple-500 mb-4">
                     <h3 className="text-purple-400 font-bold">Demo Racer (K√∂lcs√∂nz√∂tt)</h3>
                     <p className="text-white text-sm">300 HP / 60 Handling</p>
                     <button 
                        onClick={() => startRace({ name: 'Demo Racer', currentHp: 300, currentHandling: 60 })}
                        disabled={racing}
                        className="mt-2 w-full bg-purple-700 hover:bg-purple-600 text-white py-2 rounded"
                     >
                       {racing ? 'Verseny folyamatban...' : 'Indul√°s a Drag versenyen'}
                     </button>
                   </div>
                </div>

                <div className="bg-black p-6 rounded-lg border border-slate-700 font-mono text-green-500 h-64 overflow-y-auto">
                  <h3 className="text-white border-b border-gray-700 mb-2">Race Log</h3>
                  {raceLog.map((log, i) => (
                    <div key={i} className="mb-1 animate-pulse">{log}</div>
                  ))}
                  {raceLog.length === 0 && <span className="text-gray-600">V√°rakoz√°s a versenyre...</span>}
                </div>
              </div>
            );
          };

          return (
            <div className="min-h-screen bg-slate-950 text-slate-200 font-sans selection:bg-cyan-500 selection:text-white pb-20">
              <Header />
              <Navigation />
              
              {/* √ârtes√≠t√©sek */}
              {notification && (
                <div className={`fixed bottom-4 right-4 px-6 py-3 rounded shadow-2xl z-50 animate-bounce ${notification.type === 'error' ? 'bg-red-600 text-white' : 'bg-green-500 text-black font-bold'}`}>
                  {notification.msg}
                </div>
              )}

              <main className="max-w-7xl mx-auto mt-4">
                {view === 'garage' && <GarageView />}
                {view === 'shop' && <ShopView />}
                {view === 'office' && <OfficeView />}
                {view === 'race' && <RaceView />}
              </main>

              {/* Tutorial / Intro sz√∂veg ha √ºres a gar√°zs √©s kezd≈ë vagy */}
              {day === 1 && !activeJob && reputation === 0 && view === 'garage' && (
                <div className="fixed inset-0 bg-black/80 flex items-center justify-center z-40 p-4">
                  <div className="bg-slate-800 p-8 rounded-2xl max-w-lg border-2 border-cyan-500 text-center shadow-[0_0_50px_rgba(6,182,212,0.3)]">
                    <h2 className="text-3xl font-bold text-white mb-2">√údv a <span className="text-cyan-400">StreetWorks</span>-ben!</h2>
                    <p className="text-gray-300 mb-6">Te vagy az √∫j f≈ën√∂k. Ez a gar√°zs lepukkant, de van benne potenci√°l. <br/><br/>
                    1. V√°lassz egy munk√°t a jobb oldali list√°r√≥l.<br/>
                    2. V√°s√°rolj alkatr√©szt a 'Alkatr√©szek' f√ºl√∂n.<br/>
                    3. Szereld be a gar√°zsban.<br/>
                    4. Add √°t az aut√≥t √©s szerezz h√≠rnevet!</p>
                    <button onClick={() => setReputation(1)} className="bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-3 px-8 rounded-full text-lg transition-transform hover:scale-105">
                      Kezdj√ºk!
                    </button>
                  </div>
                </div>
              )}
            </div>
          );
        }

        // App ind√≠t√°sa
        const root = createRoot(document.getElementById('root'));
        root.render(<StreetWorksGarage />);
    </script>
</body>
</html>