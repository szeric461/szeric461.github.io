<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pont√∂sszek√∂t≈ë Var√°zs</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap');

        body {
            font-family: 'Fredoka', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            overscroll-behavior: none;
            touch-action: none; /* Prevents pull-to-refresh on mobile */
        }

        .canvas-container {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
            border-radius: 1rem;
            background: rgba(255, 255, 255, 0.95);
            position: relative;
            overflow: hidden;
            touch-action: none;
        }

        .hud-overlay {
            pointer-events: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        .success-modal {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            padding: 2rem;
            border-radius: 20px;
            text-align: center;
            transform: scale(0);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        .success-modal.active {
            transform: scale(1);
            pointer-events: auto;
        }

        /* Pulsing animation for the active dot */
        @keyframes pulse-ring {
            0% { transform: scale(0.33); opacity: 0.5; }
            80%, 100% { opacity: 0; transform: scale(2); }
        }
        
        .pulse-effect {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 99, 71, 0.6);
            animation: pulse-ring 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
            pointer-events: none;
            z-index: 0;
        }

        .btn {
            transition: all 0.2s;
        }
        .btn:active {
            transform: scale(0.95);
        }

        /* Prevent text selection */
        .noselect {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>
</head>
<body class="h-screen w-full flex flex-col items-center justify-center p-4 text-gray-800 noselect">

    <!-- Header -->
    <div class="w-full max-w-2xl flex justify-between items-center mb-4 text-white">
        <div>
            <h1 class="text-2xl md:text-3xl font-bold drop-shadow-md">Pont√∂sszek√∂t≈ë</h1>
            <p class="text-sm opacity-90">K√∂sd √∂ssze a sz√°mokat sorban!</p>
        </div>
        <div class="text-right bg-white/20 px-4 py-2 rounded-lg backdrop-blur-sm">
            <span class="block text-xs uppercase tracking-wide">Szint</span>
            <span id="level-display" class="text-2xl font-bold">1 / 15</span>
        </div>
    </div>

    <!-- Game Area -->
    <div class="relative w-full max-w-2xl aspect-square md:aspect-[4/3]">
        <div id="game-container" class="canvas-container w-full h-full relative cursor-crosshair">
            <canvas id="gameCanvas" class="block w-full h-full"></canvas>
            
            <!-- Pulse effect div (moved by JS) -->
            <div id="active-pulse" class="pulse-effect w-10 h-10 hidden"></div>

            <!-- Success Overlay -->
            <div id="success-overlay" class="hud-overlay hidden">
                <div id="success-modal" class="success-modal">
                    <div class="text-6xl mb-2">üéâ</div>
                    <h2 class="text-3xl font-bold text-indigo-600 mb-2">Sz√©p munka!</h2>
                    <p id="shape-name" class="text-gray-600 mb-6 text-lg">√Åbra k√©sz!</p>
                    <button id="next-level-btn" class="btn bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-full shadow-lg text-lg">
                        K√∂vetkez≈ë p√°lya ‚ûú
                    </button>
                </div>
            </div>

             <!-- End Game Overlay -->
             <div id="endgame-overlay" class="hud-overlay hidden">
                <div id="endgame-modal" class="success-modal">
                    <div class="text-6xl mb-2">üèÜ</div>
                    <h2 class="text-3xl font-bold text-yellow-500 mb-2">Minden p√°lya teljes√≠tve!</h2>
                    <p class="text-gray-600 mb-6 text-lg">Igazi m≈±v√©sz vagy!</p>
                    <button id="restart-game-btn" class="btn bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-full shadow-lg text-lg">
                        J√°t√©k √∫jrakezd√©se ‚Ü∫
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Controls Footer -->
    <div class="mt-6 flex gap-4">
        <button id="reset-btn" class="btn bg-white/20 hover:bg-white/30 text-white backdrop-blur-md border border-white/40 font-semibold py-2 px-6 rounded-full shadow-sm flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
            </svg>
            √öjrakezd√©s
        </button>
    </div>

    <script>
        // --- Game Configuration & Data ---
        const LEVELS = [
            // 1. H√°zik√≥
            {
                name: "H√°zik√≥",
                color: "#4F46E5",
                fillColor: "rgba(79, 70, 229, 0.2)",
                points: [
                    {x: 0.2, y: 0.8}, {x: 0.2, y: 0.4}, {x: 0.5, y: 0.15}, {x: 0.8, y: 0.4}, {x: 0.8, y: 0.8}, {x: 0.2, y: 0.8}
                ]
            },
            // 2. Csillag
            {
                name: "Ragyog√≥ Csillag",
                color: "#F59E0B",
                fillColor: "rgba(245, 158, 11, 0.2)",
                points: [
                    {x: 0.5, y: 0.1}, {x: 0.61, y: 0.35}, {x: 0.88, y: 0.35}, {x: 0.66, y: 0.53}, {x: 0.75, y: 0.8},
                    {x: 0.5, y: 0.63}, {x: 0.25, y: 0.8}, {x: 0.34, y: 0.53}, {x: 0.12, y: 0.35}, {x: 0.39, y: 0.35}, {x: 0.5, y: 0.1}
                ]
            },
            // 3. Haj√≥
            {
                name: "Vitorl√°s Haj√≥",
                color: "#0EA5E9",
                fillColor: "rgba(14, 165, 233, 0.2)",
                points: [
                    {x: 0.5, y: 0.15}, {x: 0.5, y: 0.6}, {x: 0.8, y: 0.6}, {x: 0.7, y: 0.85}, {x: 0.3, y: 0.85},
                    {x: 0.2, y: 0.6}, {x: 0.5, y: 0.6}, {x: 0.2, y: 0.3}, {x: 0.5, y: 0.15}
                ]
            },
            // 4. Sz√≠v
            {
                name: "Dobog√≥ Sz√≠v",
                color: "#E11D48",
                fillColor: "rgba(225, 29, 72, 0.2)",
                points: [
                    {x: 0.5, y: 0.3}, {x: 0.6, y: 0.15}, {x: 0.8, y: 0.15}, {x: 0.9, y: 0.3}, {x: 0.9, y: 0.5},
                    {x: 0.5, y: 0.9}, {x: 0.1, y: 0.5}, {x: 0.1, y: 0.3}, {x: 0.2, y: 0.15}, {x: 0.4, y: 0.15}, {x: 0.5, y: 0.3}
                ]
            },
            // 5. Rak√©ta
            {
                name: "≈∞rrak√©ta",
                color: "#8B5CF6",
                fillColor: "rgba(139, 92, 246, 0.2)",
                points: [
                    {x: 0.5, y: 0.1}, {x: 0.65, y: 0.3}, {x: 0.65, y: 0.7}, {x: 0.8, y: 0.9}, {x: 0.65, y: 0.8},
                    {x: 0.55, y: 0.8}, {x: 0.5, y: 0.95}, {x: 0.45, y: 0.8}, {x: 0.35, y: 0.8}, {x: 0.2, y: 0.9},
                    {x: 0.35, y: 0.7}, {x: 0.35, y: 0.3}, {x: 0.5, y: 0.1}
                ]
            },
            // 6. Feny≈ëfa
            {
                name: "Feny≈ëfa",
                color: "#16a34a",
                fillColor: "rgba(22, 163, 74, 0.2)",
                points: [
                    {x: 0.45, y: 0.9}, {x: 0.55, y: 0.9}, {x: 0.55, y: 0.8}, {x: 0.8, y: 0.8}, {x: 0.6, y: 0.6},
                    {x: 0.75, y: 0.6}, {x: 0.55, y: 0.4}, {x: 0.5, y: 0.15}, {x: 0.45, y: 0.4}, {x: 0.25, y: 0.6},
                    {x: 0.4, y: 0.6}, {x: 0.2, y: 0.8}, {x: 0.45, y: 0.8}, {x: 0.45, y: 0.9}
                ]
            },
            // 7. Vill√°m
            {
                name: "Vill√°m",
                color: "#fbbf24",
                fillColor: "rgba(251, 191, 36, 0.2)",
                points: [
                    {x: 0.45, y: 0.1}, {x: 0.75, y: 0.1}, {x: 0.5, y: 0.5}, {x: 0.7, y: 0.5}, {x: 0.4, y: 0.95},
                    {x: 0.45, y: 0.6}, {x: 0.25, y: 0.6}, {x: 0.45, y: 0.1}
                ]
            },
            // 8. Gy√©m√°nt
            {
                name: "Gy√©m√°nt",
                color: "#06b6d4",
                fillColor: "rgba(6, 182, 212, 0.2)",
                points: [
                    {x: 0.3, y: 0.2}, {x: 0.7, y: 0.2}, {x: 0.9, y: 0.45}, {x: 0.5, y: 0.9}, {x: 0.1, y: 0.45}, {x: 0.3, y: 0.2}
                ]
            },
            // 9. Kisaut√≥
            {
                name: "Kisaut√≥",
                color: "#dc2626",
                fillColor: "rgba(220, 38, 38, 0.2)",
                points: [
                    {x: 0.1, y: 0.7}, {x: 0.1, y: 0.55}, {x: 0.3, y: 0.5}, {x: 0.4, y: 0.3}, {x: 0.65, y: 0.3},
                    {x: 0.75, y: 0.5}, {x: 0.9, y: 0.55}, {x: 0.9, y: 0.7}, {x: 0.75, y: 0.7}, {x: 0.75, y: 0.85},
                    {x: 0.6, y: 0.85}, {x: 0.6, y: 0.7}, {x: 0.4, y: 0.7}, {x: 0.4, y: 0.85}, {x: 0.25, y: 0.85},
                    {x: 0.25, y: 0.7}, {x: 0.1, y: 0.7}
                ]
            },
            // 10. Pillang√≥
            {
                name: "Pillang√≥",
                color: "#d946ef",
                fillColor: "rgba(217, 70, 239, 0.2)",
                points: [
                    {x: 0.5, y: 0.2}, {x: 0.9, y: 0.1}, {x: 0.95, y: 0.4}, {x: 0.8, y: 0.5}, {x: 0.9, y: 0.7},
                    {x: 0.7, y: 0.85}, {x: 0.5, y: 0.7}, {x: 0.3, y: 0.85}, {x: 0.1, y: 0.7}, {x: 0.2, y: 0.5},
                    {x: 0.05, y: 0.4}, {x: 0.1, y: 0.1}, {x: 0.5, y: 0.2}
                ]
            },
            // 11. Korona
            {
                name: "Kir√°lyi Korona",
                color: "#facc15",
                fillColor: "rgba(250, 204, 21, 0.2)",
                points: [
                    {x: 0.2, y: 0.8}, {x: 0.8, y: 0.8}, {x: 0.9, y: 0.3}, {x: 0.7, y: 0.55}, {x: 0.5, y: 0.2},
                    {x: 0.3, y: 0.55}, {x: 0.1, y: 0.3}, {x: 0.2, y: 0.8}
                ]
            },
            // 12. Eserny≈ë
            {
                name: "Eserny≈ë",
                color: "#ec4899",
                fillColor: "rgba(236, 72, 153, 0.2)",
                points: [
                    {x: 0.1, y: 0.5}, {x: 0.5, y: 0.1}, {x: 0.9, y: 0.5}, {x: 0.7, y: 0.4}, {x: 0.5, y: 0.45},
                    {x: 0.3, y: 0.4}, {x: 0.1, y: 0.5}, {x: 0.5, y: 0.45}, {x: 0.5, y: 0.85}, {x: 0.4, y: 0.9}, {x: 0.4, y: 0.85}
                ]
            },
            // 13. Aranyhal
            {
                name: "Aranyhal",
                color: "#f97316",
                fillColor: "rgba(249, 115, 22, 0.2)",
                points: [
                    {x: 0.1, y: 0.5}, {x: 0.3, y: 0.25}, {x: 0.6, y: 0.25}, {x: 0.9, y: 0.15}, {x: 0.8, y: 0.5},
                    {x: 0.9, y: 0.85}, {x: 0.6, y: 0.75}, {x: 0.3, y: 0.75}, {x: 0.1, y: 0.5}
                ]
            },
             // 14. F√©lhold
             {
                name: "F√©lhold",
                color: "#6366f1",
                fillColor: "rgba(99, 102, 241, 0.2)",
                points: [
                    {x: 0.6, y: 0.1}, {x: 0.5, y: 0.4}, {x: 0.5, y: 0.6}, {x: 0.6, y: 0.9},
                    {x: 0.4, y: 0.75}, {x: 0.3, y: 0.5}, {x: 0.4, y: 0.25}, {x: 0.6, y: 0.1}
                ]
            },
            // 15. Cica
            {
                name: "Kiscica",
                color: "#374151",
                fillColor: "rgba(55, 65, 81, 0.2)",
                points: [
                    {x: 0.2, y: 0.25}, {x: 0.5, y: 0.3}, {x: 0.8, y: 0.25}, {x: 0.9, y: 0.6}, {x: 0.5, y: 0.85},
                    {x: 0.1, y: 0.6}, {x: 0.2, y: 0.25}
                ]
            }
        ];

        // --- State Variables ---
        let currentLevelIndex = 0;
        let currentPointIndex = 0;
        let isDragging = false;
        let mousePos = { x: 0, y: 0 };
        let canvas, ctx;
        let animationFrameId;
        let canvasBounds;
        let isLevelComplete = false;

        // Constants
        const DOT_RADIUS = 12;
        const SNAP_DISTANCE = 40; // Pixels
        const LINE_WIDTH = 4;

        // --- Initialization ---
        function init() {
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            
            // Resize handler
            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();

            // Input Listeners
            canvas.addEventListener('mousedown', startInteraction);
            canvas.addEventListener('mousemove', moveInteraction);
            canvas.addEventListener('mouseup', endInteraction);
            canvas.addEventListener('mouseleave', endInteraction);

            canvas.addEventListener('touchstart', (e) => startInteraction(e.touches[0]));
            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault(); // Stop scrolling
                moveInteraction(e.touches[0]);
            });
            canvas.addEventListener('touchend', endInteraction);

            // Button Listeners
            document.getElementById('next-level-btn').addEventListener('click', nextLevel);
            document.getElementById('reset-btn').addEventListener('click', resetLevel);
            document.getElementById('restart-game-btn').addEventListener('click', restartGame);

            startLevel(0);
            gameLoop();
        }

        function resizeCanvas() {
            const container = document.getElementById('game-container');
            canvas.width = container.clientWidth * window.devicePixelRatio;
            canvas.height = container.clientHeight * window.devicePixelRatio;
            // Scale context for high DPI
            ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
            // Internal logic width/height
            canvas.style.width = `${container.clientWidth}px`;
            canvas.style.height = `${container.clientHeight}px`;
            canvasBounds = canvas.getBoundingClientRect();
        }

        function startLevel(index) {
            currentLevelIndex = index;
            currentPointIndex = 0;
            isLevelComplete = false;
            isDragging = false;
            
            document.getElementById('level-display').innerText = `${index + 1} / ${LEVELS.length}`;
            document.getElementById('success-overlay').classList.add('hidden');
            document.getElementById('success-modal').classList.remove('active');
            document.getElementById('endgame-overlay').classList.add('hidden');
            
            updatePulsePosition();
        }

        function resetLevel() {
            startLevel(currentLevelIndex);
        }

        function nextLevel() {
            if (currentLevelIndex < LEVELS.length - 1) {
                startLevel(currentLevelIndex + 1);
            } else {
                showEndGame();
            }
        }

        function restartGame() {
            startLevel(0);
        }

        // --- Interaction Logic ---
        function getRelativePos(clientObj) {
            canvasBounds = canvas.getBoundingClientRect();
            return {
                x: clientObj.clientX - canvasBounds.left,
                y: clientObj.clientY - canvasBounds.top
            };
        }

        function startInteraction(clientObj) {
            if (isLevelComplete) return;
            isDragging = true;
            mousePos = getRelativePos(clientObj);
            checkConnection(); // Check if we clicked directly on the next dot
        }

        function moveInteraction(clientObj) {
            if (isLevelComplete) return;
            mousePos = getRelativePos(clientObj);
            if (isDragging) {
                checkConnection();
            }
        }

        function endInteraction() {
            isDragging = false;
        }

        function checkConnection() {
            const level = LEVELS[currentLevelIndex];
            // Look for the NEXT point (currentPointIndex + 1)
            // But wait, we draw a line FROM currentPointIndex TO mouse.
            // So we are looking to connect to currentPointIndex + 1.
            
            const nextIdx = currentPointIndex + 1;
            if (nextIdx >= level.points.length) return;

            const target = level.points[nextIdx];
            
            // Map normalized coords to screen coords
            const w = canvasBounds.width;
            const h = canvasBounds.height;
            const targetX = target.x * w;
            const targetY = target.y * h;

            // Distance formula
            const dist = Math.sqrt((mousePos.x - targetX)**2 + (mousePos.y - targetY)**2);

            if (dist < SNAP_DISTANCE) {
                // Connected!
                currentPointIndex++;
                
                // Visual feedback (vibration if supported)
                if (navigator.vibrate) navigator.vibrate(15);

                // Check win
                if (currentPointIndex >= level.points.length - 1) {
                    completeLevel();
                } else {
                    updatePulsePosition();
                }
            }
        }

        function updatePulsePosition() {
            if(isLevelComplete) {
                document.getElementById('active-pulse').classList.add('hidden');
                return;
            }

            const level = LEVELS[currentLevelIndex];
            const nextIdx = currentPointIndex + 1;
            if (nextIdx < level.points.length) {
                const pt = level.points[nextIdx];
                const pulse = document.getElementById('active-pulse');
                
                // Need current bounds
                canvasBounds = canvas.getBoundingClientRect();
                
                pulse.style.left = `${(pt.x * canvasBounds.width) - 20}px`; // 20 is half width
                pulse.style.top = `${(pt.y * canvasBounds.height) - 20}px`;
                pulse.classList.remove('hidden');
            }
        }

        function completeLevel() {
            isLevelComplete = true;
            isDragging = false;
            document.getElementById('active-pulse').classList.add('hidden');
            
            const level = LEVELS[currentLevelIndex];
            document.getElementById('shape-name').innerText = `"${level.name}" elk√©sz√ºlt!`;
            
            // Wait a moment before showing modal so user can see the full shape
            setTimeout(() => {
                if (currentLevelIndex === LEVELS.length - 1) {
                   showEndGame();
                } else {
                    const overlay = document.getElementById('success-overlay');
                    overlay.classList.remove('hidden');
                    // Small delay for CSS transition
                    requestAnimationFrame(() => {
                        document.getElementById('success-modal').classList.add('active');
                    });
                }
                confettiEffect();
            }, 800);
        }
        
        function showEndGame() {
            const overlay = document.getElementById('endgame-overlay');
            overlay.classList.remove('hidden');
            requestAnimationFrame(() => {
                document.getElementById('endgame-modal').classList.add('active');
            });
            confettiEffect();
        }

        // --- Rendering ---
        function gameLoop() {
            render();
            animationFrameId = requestAnimationFrame(gameLoop);
        }

        function render() {
            // Logic width/height
            const w = canvas.width / window.devicePixelRatio;
            const h = canvas.height / window.devicePixelRatio;

            ctx.clearRect(0, 0, w, h);
            
            const level = LEVELS[currentLevelIndex];
            const points = level.points;

            // 1. Draw completed lines
            if (currentPointIndex > 0) {
                ctx.beginPath();
                ctx.moveTo(points[0].x * w, points[0].y * h);
                for (let i = 1; i <= currentPointIndex; i++) {
                    ctx.lineTo(points[i].x * w, points[i].y * h);
                }
                
                // Style for completed lines
                ctx.strokeStyle = level.color;
                ctx.lineWidth = LINE_WIDTH;
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';
                ctx.stroke();

                // Fill shape if complete
                if (isLevelComplete) {
                    ctx.fillStyle = level.fillColor;
                    ctx.fill();
                }
            }

            // 2. Draw active dragging line (elastic band)
            if (!isLevelComplete && currentPointIndex < points.length - 1) {
                const startPt = points[currentPointIndex];
                
                ctx.beginPath();
                ctx.moveTo(startPt.x * w, startPt.y * h);
                ctx.lineTo(mousePos.x, mousePos.y);
                
                ctx.strokeStyle = '#9CA3AF'; // Gray-400
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]); // Dashed line
                ctx.stroke();
                ctx.setLineDash([]); // Reset dash
            }

            // 3. Draw Dots & Numbers
            for (let i = 0; i < points.length; i++) {
                const px = points[i].x * w;
                const py = points[i].y * h;
                
                // Skip drawing the last dot if it overlaps with first (closed loops) 
                // ONLY for the number display, but we still need the dot logic.
                // Actually, let's just draw all.

                const isVisited = i <= currentPointIndex;
                const isNext = i === currentPointIndex + 1;
                
                // Draw Dot
                ctx.beginPath();
                ctx.arc(px, py, isVisited ? DOT_RADIUS : DOT_RADIUS - 2, 0, Math.PI * 2);
                ctx.fillStyle = isVisited ? level.color : '#E5E7EB'; // Active vs Inactive color
                if (isNext && !isLevelComplete) ctx.fillStyle = '#EF4444'; // Red for target
                ctx.fill();
                
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();

                // Draw Number (Only if not complete, to keep drawing clean)
                // Or keep numbers but fade them? Let's keep them small.
                if (!isLevelComplete && i > 0 && i !== points.length - 1) { 
                     // Logic: Don't number start point (it's "1" effectively but we started there)
                     // Actually, let's number them 1, 2, 3...
                }

                if (!isLevelComplete && i > currentPointIndex) {
                     ctx.fillStyle = '#4B5563';
                     ctx.font = 'bold 14px Fredoka';
                     ctx.textAlign = 'center';
                     ctx.textBaseline = 'middle';
                     
                     // Offset number slightly so it's not inside the dot unless it's huge
                     // Actually inside is cleaner for game design
                     ctx.fillStyle = '#fff';
                     if (isNext) {
                         ctx.fillStyle = '#fff'; // White text on red dot
                     } else {
                         ctx.fillStyle = '#9CA3AF'; // Grey text on grey dot
                     }
                     // Only show number for next points
                     ctx.fillText(i + 1, px, py);
                }
            }
            
            // Special: Highlight the starting point if index is 0
            if (currentPointIndex === 0 && !isLevelComplete) {
                const p0 = points[0];
                ctx.fillStyle = level.color;
                ctx.font = 'bold 16px Fredoka';
                ctx.fillText("Start", (p0.x * w), (p0.y * h) - 25);
            }
        }

        // --- Confetti Effect (Simple Implementation) ---
        function confettiEffect() {
            const count = 100;
            const container = document.getElementById('game-container');
            const w = container.clientWidth;
            
            for (let i = 0; i < count; i++) {
                const conf = document.createElement('div');
                conf.style.position = 'absolute';
                conf.style.width = '8px';
                conf.style.height = '8px';
                conf.style.backgroundColor = ['#f00', '#0f0', '#00f', '#ff0', '#0ff'][Math.floor(Math.random() * 5)];
                conf.style.left = Math.random() * 100 + '%';
                conf.style.top = '-10px';
                conf.style.borderRadius = '50%';
                conf.style.zIndex = '5';
                conf.style.transition = `top ${1 + Math.random()}s ease-in, opacity 1s ease-out`;
                
                container.appendChild(conf);

                setTimeout(() => {
                    conf.style.top = '110%';
                    conf.style.opacity = '0';
                }, 50);

                setTimeout(() => {
                    conf.remove();
                }, 2000);
            }
        }

        // Start
        window.onload = init;

    </script>
</body>
</html>